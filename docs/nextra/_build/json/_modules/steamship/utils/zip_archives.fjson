{"parents": [{"link": "../../../", "title": "Module code"}], "title": "steamship.utils.zip_archives", "body": "<h1>Source code for steamship.utils.zip_archives</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">import</span> <span class=\"nn\">shutil</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pathlib</span> <span class=\"kn\">import</span> <span class=\"n\">Path</span>\n<span class=\"kn\">from</span> <span class=\"nn\">typing</span> <span class=\"kn\">import</span> <span class=\"n\">Optional</span>\n\n\n<div class=\"viewcode-block\" id=\"zip_folder\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.utils/#steamship.utils.zip_archives.zip_folder\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">zip_folder</span><span class=\"p\">(</span><span class=\"n\">folder</span><span class=\"p\">:</span> <span class=\"n\">Path</span><span class=\"p\">,</span> <span class=\"n\">into_file</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"n\">Path</span><span class=\"p\">])</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Path</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Zips a folder on disk to a co-located zip-file of the same name.</span>\n\n<span class=\"sd\">    The resulting zip file does not contain the enclosing folder name provided.</span>\n<span class=\"sd\">    It contains only the children of that folder as its root elements.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Zipping: </span><span class=\"si\">{</span><span class=\"n\">folder</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">shutil</span><span class=\"o\">.</span><span class=\"n\">make_archive</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">folder</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">rstrip</span><span class=\"p\">(</span><span class=\"s2\">&quot;/&quot;</span><span class=\"p\">),</span> <span class=\"s2\">&quot;zip&quot;</span><span class=\"p\">,</span> <span class=\"n\">folder</span><span class=\"p\">)</span>\n    <span class=\"n\">zip_path_str</span> <span class=\"o\">=</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">folder</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">rstrip</span><span class=\"p\">(</span><span class=\"s2\">&quot;/&quot;</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;.zip&quot;</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Zipped: </span><span class=\"si\">{</span><span class=\"n\">zip_path_str</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">into_file</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">Path</span><span class=\"p\">(</span><span class=\"n\">zip_path_str</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Move the archive to the desired destination</span>\n\n    <span class=\"c1\"># Ensure the path to the desired extraction folder exists</span>\n    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">into_file</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"o\">.</span><span class=\"n\">exists</span><span class=\"p\">():</span>\n        <span class=\"n\">into_file</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"o\">.</span><span class=\"n\">mkdir</span><span class=\"p\">(</span><span class=\"n\">parents</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">exist_ok</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n    <span class=\"n\">shutil</span><span class=\"o\">.</span><span class=\"n\">move</span><span class=\"p\">(</span><span class=\"n\">zip_path_str</span><span class=\"p\">,</span> <span class=\"n\">into_file</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">into_file</span></div>\n\n\n<div class=\"viewcode-block\" id=\"unzip_folder\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.utils/#steamship.utils.zip_archives.unzip_folder\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">unzip_folder</span><span class=\"p\">(</span><span class=\"n\">zip_file</span><span class=\"p\">:</span> <span class=\"n\">Path</span><span class=\"p\">,</span> <span class=\"n\">into_folder</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"n\">Path</span><span class=\"p\">])</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Path</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Unzips a folder on disk, returning the path to the new folder resulting.&quot;&quot;&quot;</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Unzipping: </span><span class=\"si\">{</span><span class=\"n\">zip_file</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">into_folder</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"n\">into_folder</span> <span class=\"o\">=</span> <span class=\"n\">zip_file</span><span class=\"o\">.</span><span class=\"n\">with_suffix</span><span class=\"p\">(</span><span class=\"s2\">&quot;&quot;</span><span class=\"p\">)</span>  <span class=\"c1\"># Strips the &#39;.zip&#39; suffix</span>\n\n    <span class=\"c1\"># Ensure the path to the desired extraction folder exists</span>\n    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">into_folder</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"o\">.</span><span class=\"n\">exists</span><span class=\"p\">():</span>\n        <span class=\"n\">into_folder</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"o\">.</span><span class=\"n\">mkdir</span><span class=\"p\">(</span><span class=\"n\">parents</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">exist_ok</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n    <span class=\"n\">shutil</span><span class=\"o\">.</span><span class=\"n\">unpack_archive</span><span class=\"p\">(</span><span class=\"n\">zip_file</span><span class=\"p\">,</span> <span class=\"n\">into_folder</span><span class=\"p\">,</span> <span class=\"s2\">&quot;zip&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Unzipped: </span><span class=\"si\">{</span><span class=\"n\">into_folder</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">Path</span><span class=\"p\">(</span><span class=\"n\">into_folder</span><span class=\"p\">)</span></div>\n</pre></div>", "current_page_name": "_modules/steamship/utils/zip_archives", "sidebars": ["sidebar/brand.html", "sidebar/search.html", "sidebar/scroll-start.html", "sidebar/navigation.html", "sidebar/ethical-ads.html", "sidebar/scroll-end.html", "sidebar/variant-selector.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "furo_version": "2023.03.27", "furo_navigation_tree": "", "furo_hide_toc": true, "furo_pygments": {"light": {"background": "#f8f8f8", "foreground": "black"}, "dark": {"background": "#272822", "foreground": "#f8f8f2"}}}