{"parents": [{"link": "../../../", "title": "Module code"}], "title": "steamship.plugin.trainable_model", "body": "<h1>Source code for steamship.plugin.trainable_model</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">from</span> <span class=\"nn\">abc</span> <span class=\"kn\">import</span> <span class=\"n\">ABC</span><span class=\"p\">,</span> <span class=\"n\">abstractmethod</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pathlib</span> <span class=\"kn\">import</span> <span class=\"n\">Path</span>\n<span class=\"kn\">from</span> <span class=\"nn\">typing</span> <span class=\"kn\">import</span> <span class=\"n\">Callable</span><span class=\"p\">,</span> <span class=\"n\">Dict</span><span class=\"p\">,</span> <span class=\"n\">Generic</span><span class=\"p\">,</span> <span class=\"n\">Optional</span><span class=\"p\">,</span> <span class=\"n\">TypeVar</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">typing_extensions</span> <span class=\"kn\">import</span> <span class=\"n\">TypeAlias</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.base.client</span> <span class=\"kn\">import</span> <span class=\"n\">Client</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.invocable</span> <span class=\"kn\">import</span> <span class=\"n\">InvocableResponse</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.invocable.plugin_service</span> <span class=\"kn\">import</span> <span class=\"n\">PluginRequest</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.plugin.inputs.train_plugin_input</span> <span class=\"kn\">import</span> <span class=\"n\">TrainPluginInput</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.plugin.outputs.model_checkpoint</span> <span class=\"kn\">import</span> <span class=\"n\">ModelCheckpoint</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.plugin.outputs.train_plugin_output</span> <span class=\"kn\">import</span> <span class=\"n\">TrainPluginOutput</span>\n\n<span class=\"n\">ModelConstructor</span><span class=\"p\">:</span> <span class=\"n\">TypeAlias</span> <span class=\"o\">=</span> <span class=\"n\">Callable</span><span class=\"p\">[[],</span> <span class=\"s2\">&quot;TrainableModel&quot;</span><span class=\"p\">]</span>\n\n<span class=\"c1\"># Global variable to store the model for reuse in memory.</span>\n<span class=\"n\">MODEL_CACHE</span><span class=\"p\">:</span> <span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"s2\">&quot;TrainableModel&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n<span class=\"n\">ConfigType</span> <span class=\"o\">=</span> <span class=\"n\">TypeVar</span><span class=\"p\">(</span><span class=\"s2\">&quot;ConfigType&quot;</span><span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"TrainableModel\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">TrainableModel</span><span class=\"p\">(</span><span class=\"n\">ABC</span><span class=\"p\">,</span> <span class=\"n\">Generic</span><span class=\"p\">[</span><span class=\"n\">ConfigType</span><span class=\"p\">]):</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Base class for trainable models.</span>\n\n<span class=\"sd\">    Trainable models are not plugins. They are a thin wrapper around the state of a model designed to be **used with**</span>\n<span class=\"sd\">    the Steamship plugin system.</span>\n\n<span class=\"sd\">    # State Management</span>\n\n<span class=\"sd\">    100% of a TrainableModel&#39;s state management should save to &amp; read from a folder on disk via the methods</span>\n<span class=\"sd\">    `save_to_folder` and `load_from_folder`.</span>\n\n<span class=\"sd\">    # Remote Saving and Loading</span>\n\n<span class=\"sd\">    `TrainableModel` instances automatically save to a user&#39;s Workspace on Steamship via `save_remote` method. They</span>\n<span class=\"sd\">    can load themselves from a user&#39;s workspace via the `load_remote` method.</span>\n\n<span class=\"sd\">    When saving a model, the caller provides `handle`, such as &quot;V1&quot; or &quot;epoch_23&quot;. This allows that particular checkpoint</span>\n<span class=\"sd\">    to be re-loaded. By default, every save operation also saves the model to the &quot;default&quot; checkpoint, overwriting it</span>\n<span class=\"sd\">    if it already existed. When a user loads a model without specifying a checkpoint, the &quot;default&quot; checkpoint will be used.</span>\n\n<span class=\"sd\">    # Data Scope</span>\n\n<span class=\"sd\">    A TrainableModel&#39;s data is saved &amp; loaded with respect to</span>\n\n<span class=\"sd\">    1) The user&#39;s active Workspace, and</span>\n<span class=\"sd\">    2) The provided Plugin Instance within that workspace.</span>\n\n<span class=\"sd\">    The active workspace is read from the Steamship client context, and the `plugin_instance_id` is supplied as a</span>\n<span class=\"sd\">    method argument on the `save_remote` and `load_remote` methods.</span>\n\n<span class=\"sd\">    This organization enables a user to have arbitrarily many trained model instances of the same type colocated within</span>\n<span class=\"sd\">    a Workspace.</span>\n\n<span class=\"sd\">    # Training</span>\n\n<span class=\"sd\">    A training job is fully parameterized by the `TrainPluginInput` object.</span>\n\n<span class=\"sd\">    # Result Reporting</span>\n\n<span class=\"sd\">    A training job&#39;s results are reported via the `TrainPluginOutput` object. These results include a reference to the</span>\n<span class=\"sd\">    `save_remote` output, but they do not include the model parameters themselves. For example, after training, one</span>\n<span class=\"sd\">    could write:</span>\n\n<span class=\"sd\">    &gt;&gt;&gt; archive_path_in_steamship = model.save_remote(..)</span>\n<span class=\"sd\">    &gt;&gt;&gt; output = TrainPluginOutput(archive_path_in_steamship=archive_path_in_steamship,</span>\n<span class=\"sd\">        ...</span>\n<span class=\"sd\">        )</span>\n\n<span class=\"sd\">    That output is the ultimate return object of the training process, but the Plugin that owns this model need not</span>\n<span class=\"sd\">    wait for synchronous completion to update the Steamship Engine with intermediate results. It can use the</span>\n<span class=\"sd\">    `Response.post_update` to proactively stream results back to the server.</span>\n\n<span class=\"sd\">    # Third-party / External Models</span>\n\n<span class=\"sd\">    This model class is a convenient wrapper for models running on third party systems (e.g. Google&#39;s AutoML). In such</span>\n<span class=\"sd\">    a case:</span>\n\n<span class=\"sd\">    - The `train` method would begin the job on the 3rd party system.</span>\n<span class=\"sd\">    - The `save_to_folder` method would write the Job ID and any other useful data to the checkpoint path</span>\n<span class=\"sd\">    - The `load_from_folder` method would read this Job ID from disk and obtain an authenticated client with the</span>\n<span class=\"sd\">      third party system.</span>\n<span class=\"sd\">    - Any `run` method the implementer created would ferry back results fetched from the third-party system.</span>\n<span class=\"sd\">    - Any status reporting in TrainPluginOutput would ferry back status fetched from the third-party system.</span>\n\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"n\">config</span><span class=\"p\">:</span> <span class=\"n\">ConfigType</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.receive_config\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.receive_config\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">receive_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">:</span> <span class=\"n\">ConfigType</span><span class=\"p\">):</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Stores config from plugin instance, so it is accessible by model on load or train.&quot;&quot;&quot;</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span> <span class=\"o\">=</span> <span class=\"n\">config</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.save_to_folder\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.save_to_folder\">[docs]</a>    <span class=\"nd\">@abstractmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">save_to_folder</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">checkpoint_path</span><span class=\"p\">:</span> <span class=\"n\">Path</span><span class=\"p\">):</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Saves 100% of the state of this model to the provided path.&quot;&quot;&quot;</span>\n        <span class=\"k\">raise</span> <span class=\"ne\">NotImplementedError</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.load_from_folder\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.load_from_folder\">[docs]</a>    <span class=\"nd\">@abstractmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">load_from_folder</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">checkpoint_path</span><span class=\"p\">:</span> <span class=\"n\">Path</span><span class=\"p\">):</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Load 100% of the state of this model to the provided path.&quot;&quot;&quot;</span>\n        <span class=\"k\">raise</span> <span class=\"ne\">NotImplementedError</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.train\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.train\">[docs]</a>    <span class=\"nd\">@abstractmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">train</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"nb\">input</span><span class=\"p\">:</span> <span class=\"n\">PluginRequest</span><span class=\"p\">[</span><span class=\"n\">TrainPluginInput</span><span class=\"p\">])</span> <span class=\"o\">-&gt;</span> <span class=\"n\">InvocableResponse</span><span class=\"p\">[</span><span class=\"n\">TrainPluginOutput</span><span class=\"p\">]:</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Train or fine-tune the model, parameterized by the information in the TrainPluginInput object.&quot;&quot;&quot;</span>\n        <span class=\"k\">raise</span> <span class=\"ne\">NotImplementedError</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.train_status\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.train_status\">[docs]</a>    <span class=\"nd\">@abstractmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">train_status</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"nb\">input</span><span class=\"p\">:</span> <span class=\"n\">PluginRequest</span><span class=\"p\">[</span><span class=\"n\">TrainPluginInput</span><span class=\"p\">]</span>\n    <span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">InvocableResponse</span><span class=\"p\">[</span><span class=\"n\">TrainPluginOutput</span><span class=\"p\">]:</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Check on the status of an in-process training job, if it is running externally asynchronously.&quot;&quot;&quot;</span>\n        <span class=\"k\">raise</span> <span class=\"ne\">NotImplementedError</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.load_from_local_checkpoint\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.load_from_local_checkpoint\">[docs]</a>    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">load_from_local_checkpoint</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">checkpoint</span><span class=\"p\">:</span> <span class=\"n\">ModelCheckpoint</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">:</span> <span class=\"n\">ConfigType</span><span class=\"p\">):</span>\n        <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"bp\">cls</span><span class=\"p\">()</span>\n        <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">receive_config</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"o\">=</span><span class=\"n\">config</span><span class=\"p\">)</span>\n        <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">load_from_folder</span><span class=\"p\">(</span><span class=\"n\">checkpoint</span><span class=\"o\">.</span><span class=\"n\">folder_path_on_disk</span><span class=\"p\">())</span>\n        <span class=\"k\">return</span> <span class=\"n\">model</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.load_remote\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.load_remote\">[docs]</a>    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">load_remote</span><span class=\"p\">(</span>\n        <span class=\"bp\">cls</span><span class=\"p\">,</span>\n        <span class=\"n\">client</span><span class=\"p\">:</span> <span class=\"n\">Client</span><span class=\"p\">,</span>\n        <span class=\"n\">plugin_instance_id</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span>\n        <span class=\"n\">checkpoint_handle</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">use_cache</span><span class=\"p\">:</span> <span class=\"nb\">bool</span> <span class=\"o\">=</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n        <span class=\"n\">model_parent_directory</span><span class=\"p\">:</span> <span class=\"n\">Path</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">plugin_instance_config</span><span class=\"p\">:</span> <span class=\"n\">ConfigType</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">checkpoint_handle</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"c1\"># For some reason doing this defaulting in the signature wasn&#39;t working.</span>\n            <span class=\"n\">checkpoint_handle</span> <span class=\"o\">=</span> <span class=\"n\">ModelCheckpoint</span><span class=\"o\">.</span><span class=\"n\">DEFAULT_HANDLE</span>\n\n        <span class=\"n\">model_key</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"si\">{</span><span class=\"n\">plugin_instance_id</span><span class=\"si\">}</span><span class=\"s2\">/</span><span class=\"si\">{</span><span class=\"n\">checkpoint_handle</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span>\n        <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;TrainableModel:load_remote - Model Key: </span><span class=\"si\">{</span><span class=\"n\">model_key</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n        <span class=\"k\">global</span> <span class=\"n\">MODEL_CACHE</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">use_cache</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">model_key</span> <span class=\"ow\">in</span> <span class=\"n\">MODEL_CACHE</span><span class=\"p\">:</span>\n                <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;TrainableModel:load_remote - Returning cached: </span><span class=\"si\">{</span><span class=\"n\">model_key</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n                <span class=\"k\">return</span> <span class=\"n\">MODEL_CACHE</span><span class=\"p\">[</span><span class=\"n\">model_key</span><span class=\"p\">]</span>\n\n        <span class=\"n\">checkpoint</span> <span class=\"o\">=</span> <span class=\"n\">ModelCheckpoint</span><span class=\"p\">(</span>\n            <span class=\"n\">client</span><span class=\"o\">=</span><span class=\"n\">client</span><span class=\"p\">,</span>\n            <span class=\"n\">parent_directory</span><span class=\"o\">=</span><span class=\"n\">model_parent_directory</span><span class=\"p\">,</span>\n            <span class=\"n\">handle</span><span class=\"o\">=</span><span class=\"n\">checkpoint_handle</span><span class=\"p\">,</span>\n            <span class=\"n\">plugin_instance_id</span><span class=\"o\">=</span><span class=\"n\">plugin_instance_id</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"c1\"># If we haven&#39;t loaded the model, we need to download and start the model</span>\n        <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;TrainableModel:load_remote - Downloading: </span><span class=\"si\">{</span><span class=\"n\">model_key</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">checkpoint</span><span class=\"o\">.</span><span class=\"n\">download_model_bundle</span><span class=\"p\">()</span>\n        <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;TrainableModel:load_remote - Loading: </span><span class=\"si\">{</span><span class=\"n\">model_key</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"bp\">cls</span><span class=\"o\">.</span><span class=\"n\">load_from_local_checkpoint</span><span class=\"p\">(</span><span class=\"n\">checkpoint</span><span class=\"p\">,</span> <span class=\"n\">plugin_instance_config</span><span class=\"p\">)</span>\n        <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;TrainableModel:load_remote - Loaded: </span><span class=\"si\">{</span><span class=\"n\">model_key</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">use_cache</span><span class=\"p\">:</span>\n            <span class=\"n\">MODEL_CACHE</span><span class=\"p\">[</span><span class=\"n\">model_key</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">model</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">model</span></div>\n\n<div class=\"viewcode-block\" id=\"TrainableModel.save_remote\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.plugin/#steamship.plugin.trainable_model.TrainableModel.save_remote\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">save_remote</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span>\n        <span class=\"n\">client</span><span class=\"p\">:</span> <span class=\"n\">Client</span><span class=\"p\">,</span>\n        <span class=\"n\">plugin_instance_id</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">,</span>\n        <span class=\"n\">checkpoint_handle</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">model_parent_directory</span><span class=\"p\">:</span> <span class=\"n\">Path</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">set_as_default</span><span class=\"p\">:</span> <span class=\"nb\">bool</span> <span class=\"o\">=</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"n\">checkpoint_handle</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"c1\"># For some reason doing this defaulting in the signature wasn&#39;t working.</span>\n            <span class=\"n\">checkpoint_handle</span> <span class=\"o\">=</span> <span class=\"n\">ModelCheckpoint</span><span class=\"o\">.</span><span class=\"n\">DEFAULT_HANDLE</span>\n\n        <span class=\"n\">checkpoint</span> <span class=\"o\">=</span> <span class=\"n\">ModelCheckpoint</span><span class=\"p\">(</span>\n            <span class=\"n\">client</span><span class=\"o\">=</span><span class=\"n\">client</span><span class=\"p\">,</span>\n            <span class=\"n\">parent_directory</span><span class=\"o\">=</span><span class=\"n\">model_parent_directory</span><span class=\"p\">,</span>\n            <span class=\"n\">handle</span><span class=\"o\">=</span><span class=\"n\">checkpoint_handle</span><span class=\"p\">,</span>\n            <span class=\"n\">plugin_instance_id</span><span class=\"o\">=</span><span class=\"n\">plugin_instance_id</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">save_to_folder</span><span class=\"p\">(</span><span class=\"n\">checkpoint</span><span class=\"o\">.</span><span class=\"n\">folder_path_on_disk</span><span class=\"p\">())</span>\n        <span class=\"n\">checkpoint</span><span class=\"o\">.</span><span class=\"n\">upload_model_bundle</span><span class=\"p\">(</span><span class=\"n\">set_as_default</span><span class=\"o\">=</span><span class=\"n\">set_as_default</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">checkpoint</span><span class=\"o\">.</span><span class=\"n\">archive_path_in_steamship</span><span class=\"p\">()</span></div></div>\n</pre></div>", "current_page_name": "_modules/steamship/plugin/trainable_model", "sidebars": ["sidebar/brand.html", "sidebar/search.html", "sidebar/scroll-start.html", "sidebar/navigation.html", "sidebar/ethical-ads.html", "sidebar/scroll-end.html", "sidebar/variant-selector.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "furo_version": "2023.03.27", "furo_navigation_tree": "", "furo_hide_toc": true, "furo_pygments": {"light": {"background": "#f8f8f8", "foreground": "black"}, "dark": {"background": "#272822", "foreground": "#f8f8f2"}}}