{"parents": [{"link": "../../../", "title": "Module code"}], "title": "steamship.cli.manifest_init_wizard", "body": "<h1>Source code for steamship.cli.manifest_init_wizard</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">import</span> <span class=\"nn\">re</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">click</span>\n<span class=\"kn\">from</span> <span class=\"nn\">click</span> <span class=\"kn\">import</span> <span class=\"n\">BadParameter</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">steamship</span> <span class=\"kn\">import</span> <span class=\"n\">Steamship</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.data.manifest</span> <span class=\"kn\">import</span> <span class=\"n\">Manifest</span><span class=\"p\">,</span> <span class=\"n\">PluginConfig</span><span class=\"p\">,</span> <span class=\"n\">SteamshipRegistry</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.data.user</span> <span class=\"kn\">import</span> <span class=\"n\">User</span>\n\n\n<div class=\"viewcode-block\" id=\"validate_handle\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.cli/#steamship.cli.manifest_init_wizard.validate_handle\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">validate_handle</span><span class=\"p\">(</span><span class=\"n\">handle</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"n\">re</span><span class=\"o\">.</span><span class=\"n\">fullmatch</span><span class=\"p\">(</span><span class=\"sa\">r</span><span class=\"s2\">&quot;[a-z\\-]+&quot;</span><span class=\"p\">,</span> <span class=\"n\">handle</span><span class=\"p\">)</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">handle</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">raise</span> <span class=\"n\">BadParameter</span><span class=\"p\">(</span><span class=\"s2\">&quot;Handle must only include lowercase letters and -&quot;</span><span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"validate_version_handle\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.cli/#steamship.cli.manifest_init_wizard.validate_version_handle\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">validate_version_handle</span><span class=\"p\">(</span><span class=\"n\">handle</span><span class=\"p\">:</span> <span class=\"nb\">str</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"n\">re</span><span class=\"o\">.</span><span class=\"n\">fullmatch</span><span class=\"p\">(</span><span class=\"sa\">r</span><span class=\"s2\">&quot;[a-z0-9\\-.]+&quot;</span><span class=\"p\">,</span> <span class=\"n\">handle</span><span class=\"p\">)</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">handle</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">raise</span> <span class=\"n\">BadParameter</span><span class=\"p\">(</span><span class=\"s2\">&quot;Handle must only include lowercase letters, numbers, . and -&quot;</span><span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"manifest_init_wizard\"><a class=\"viewcode-back\" href=\"../../../../api/steamship.cli/#steamship.cli.manifest_init_wizard.manifest_init_wizard\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">manifest_init_wizard</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"p\">:</span> <span class=\"n\">Steamship</span><span class=\"p\">):</span>\n    <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">secho</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;It looks like you don&#39;t yet have a steamship.json to deploy. Let&#39;s create one.&quot;</span><span class=\"p\">,</span>\n        <span class=\"n\">fg</span><span class=\"o\">=</span><span class=\"s2\">&quot;cyan&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n    <span class=\"n\">deployable_type</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;Is this a package or a plugin?&quot;</span><span class=\"p\">,</span>\n        <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s2\">&quot;package&quot;</span><span class=\"p\">,</span>\n        <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">Choice</span><span class=\"p\">([</span><span class=\"s2\">&quot;package&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;plugin&quot;</span><span class=\"p\">]),</span>\n        <span class=\"n\">show_choices</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n    <span class=\"n\">handle</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span>\n        <span class=\"sa\">f</span><span class=\"s2\">&quot;What handle would you like to use for your </span><span class=\"si\">{</span><span class=\"n\">deployable_type</span><span class=\"si\">}</span><span class=\"s2\">? Valid characters are a-z and -&quot;</span><span class=\"p\">,</span>\n        <span class=\"n\">value_proc</span><span class=\"o\">=</span><span class=\"n\">validate_handle</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n    <span class=\"c1\"># TODO: claim the handle right here!</span>\n\n    <span class=\"n\">version_handle</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;0.0.1&quot;</span>\n\n    <span class=\"n\">plugin_detail</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n    <span class=\"k\">if</span> <span class=\"n\">deployable_type</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;plugin&quot;</span><span class=\"p\">:</span>\n        <span class=\"n\">plugin_type</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;What type of plugin is this?&quot;</span><span class=\"p\">,</span>\n            <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s2\">&quot;tagger&quot;</span><span class=\"p\">,</span>\n            <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">Choice</span><span class=\"p\">(</span>\n                <span class=\"p\">[</span><span class=\"s2\">&quot;tagger&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;blockifier&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;exporter&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;fileImporter&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;corpusImporter&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;generator&quot;</span><span class=\"p\">]</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">show_choices</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">plugin_type</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;tagger&quot;</span><span class=\"p\">:</span>\n            <span class=\"n\">trainable</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">confirm</span><span class=\"p\">(</span><span class=\"s2\">&quot;Is the plugin trainable?&quot;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">trainable</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n        <span class=\"n\">plugin_detail</span> <span class=\"o\">=</span> <span class=\"n\">PluginConfig</span><span class=\"p\">(</span><span class=\"n\">isTrainable</span><span class=\"o\">=</span><span class=\"n\">trainable</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"n\">plugin_type</span><span class=\"p\">)</span>\n\n    <span class=\"n\">public</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">confirm</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Do you want this </span><span class=\"si\">{</span><span class=\"n\">deployable_type</span><span class=\"si\">}</span><span class=\"s2\"> to be public?&quot;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n    <span class=\"n\">user</span> <span class=\"o\">=</span> <span class=\"n\">User</span><span class=\"o\">.</span><span class=\"n\">current</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"p\">)</span>\n\n    <span class=\"n\">author</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span><span class=\"s2\">&quot;How should we list your author name?&quot;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">handle</span><span class=\"p\">)</span>\n\n    <span class=\"n\">tagline</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n    <span class=\"n\">author_github</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n    <span class=\"k\">if</span> <span class=\"n\">public</span><span class=\"p\">:</span>\n        <span class=\"n\">tagline</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Want to give the </span><span class=\"si\">{</span><span class=\"n\">deployable_type</span><span class=\"si\">}</span><span class=\"s2\"> a tagline?&quot;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s2\">&quot;&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">author_github</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;If you&#39;d like this associated with your github account, please your github username&quot;</span><span class=\"p\">,</span>\n            <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s2\">&quot;&quot;</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"n\">tag_string</span> <span class=\"o\">=</span> <span class=\"n\">click</span><span class=\"o\">.</span><span class=\"n\">prompt</span><span class=\"p\">(</span>\n        <span class=\"sa\">f</span><span class=\"s2\">&quot;Want to give the </span><span class=\"si\">{</span><span class=\"n\">deployable_type</span><span class=\"si\">}</span><span class=\"s2\"> some tags? (comma separated)&quot;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s2\">&quot;Prompt API&quot;</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">tags</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tag</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">tag</span> <span class=\"ow\">in</span> <span class=\"n\">tag_string</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s2\">&quot;,&quot;</span><span class=\"p\">)]</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">Manifest</span><span class=\"p\">(</span>\n        <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"n\">deployable_type</span><span class=\"p\">,</span>\n        <span class=\"n\">handle</span><span class=\"o\">=</span><span class=\"n\">handle</span><span class=\"p\">,</span>\n        <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"n\">version_handle</span><span class=\"p\">,</span>\n        <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"s2\">&quot;&quot;</span><span class=\"p\">,</span>\n        <span class=\"n\">author</span><span class=\"o\">=</span><span class=\"n\">author</span><span class=\"p\">,</span>\n        <span class=\"n\">public</span><span class=\"o\">=</span><span class=\"n\">public</span><span class=\"p\">,</span>\n        <span class=\"n\">plugin</span><span class=\"o\">=</span><span class=\"n\">plugin_detail</span><span class=\"p\">,</span>\n        <span class=\"n\">build_config</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">&quot;ignore&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;tests&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;examples&quot;</span><span class=\"p\">]},</span>\n        <span class=\"n\">configTemplate</span><span class=\"o\">=</span><span class=\"p\">{},</span>\n        <span class=\"n\">steamshipRegistry</span><span class=\"o\">=</span><span class=\"n\">SteamshipRegistry</span><span class=\"p\">(</span>\n            <span class=\"n\">tagline</span><span class=\"o\">=</span><span class=\"n\">tagline</span><span class=\"p\">,</span> <span class=\"n\">authorGithub</span><span class=\"o\">=</span><span class=\"n\">author_github</span><span class=\"p\">,</span> <span class=\"n\">authorName</span><span class=\"o\">=</span><span class=\"n\">author</span><span class=\"p\">,</span> <span class=\"n\">tags</span><span class=\"o\">=</span><span class=\"n\">tags</span>\n        <span class=\"p\">),</span>\n    <span class=\"p\">)</span></div>\n</pre></div>", "current_page_name": "_modules/steamship/cli/manifest_init_wizard", "sidebars": ["sidebar/brand.html", "sidebar/search.html", "sidebar/scroll-start.html", "sidebar/navigation.html", "sidebar/ethical-ads.html", "sidebar/scroll-end.html", "sidebar/variant-selector.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "furo_version": "2023.03.27", "furo_navigation_tree": "", "furo_hide_toc": true, "furo_pygments": {"light": {"background": "#f8f8f8", "foreground": "black"}, "dark": {"background": "#272822", "foreground": "#f8f8f2"}}}