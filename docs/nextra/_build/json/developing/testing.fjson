{"parents": [{"link": "../", "title": "Developing Packages and Plugins"}], "prev": {"link": "../running/", "title": "Running on Localhost"}, "next": {"link": "../deploying/", "title": "Deploying"}, "title": "Throw, Log, and Test!", "meta": {}, "body": "<section id=\"throw-log-and-test\">\n<span id=\"testing\"></span><h1>Throw, Log, and Test!<a class=\"headerlink\" href=\"#throw-log-and-test\" title=\"Permalink to this heading\">#</a></h1>\n<p>Steamship plugins execute remotely, automatically, and potentially at high-scale.\nThis makes it critical that you:</p>\n<ul class=\"simple\">\n<li><p>Throw detailed exceptions eagerly</p></li>\n<li><p>Log liberally</p></li>\n<li><p>Write unit tests</p></li>\n</ul>\n<p>Every plugin template comes with a detailed logging and testing setup.</p>\n<section id=\"logging\">\n<h2>Logging<a class=\"headerlink\" href=\"#logging\" title=\"Permalink to this heading\">#</a></h2>\n<p>We recommend that you log liberally within your plugin code.\nUse Python\u2019s default <code class=\"docutils literal notranslate\"><span class=\"pre\">logging</span></code> library.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s2\">&quot;Hi there!&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"throwing-errors\">\n<h2>Throwing Errors<a class=\"headerlink\" href=\"#throwing-errors\" title=\"Permalink to this heading\">#</a></h2>\n<p>When something goes wrong in a plugin, the correct response is to throw a <code class=\"docutils literal notranslate\"><span class=\"pre\">SteamshipError</span></code>.\nThis will result in an error message returned to the end-user.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">steamship</span> <span class=\"kn\">import</span> <span class=\"n\">SteamshipError</span>\n<span class=\"k\">raise</span> <span class=\"n\">SteamshipError</span><span class=\"p\">(</span>\n   <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s2\">&quot;Some error message&quot;</span><span class=\"p\">,</span>\n   <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">optional_wrapped_error</span>\n<span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"manual-testing\">\n<h2>Manual Testing<a class=\"headerlink\" href=\"#manual-testing\" title=\"Permalink to this heading\">#</a></h2>\n<p>Your plugin template comes with a <code class=\"docutils literal notranslate\"><span class=\"pre\">test/</span></code> folder that stores <code class=\"docutils literal notranslate\"><span class=\"pre\">pytest</span></code> tests. You can run them with:</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>pytest\n</pre></div>\n</div>\n<p>Many templates additionally contain a <code class=\"docutils literal notranslate\"><span class=\"pre\">test_data/</span></code> folder with data that is read in as part of testing.</p>\n<p>On your local machine, any tests will run using the run using the <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_API_KEY</span></code> environment variable, if available, or using the key specified in your user-global Steamship settings (<code class=\"docutils literal notranslate\"><span class=\"pre\">~/.steamship.json</span></code>).</p>\n</section>\n<section id=\"automated-testing\">\n<h2>Automated testing<a class=\"headerlink\" href=\"#automated-testing\" title=\"Permalink to this heading\">#</a></h2>\n<p>Your plugin template comes configured to auto-test upon pull-requests to the <code class=\"docutils literal notranslate\"><span class=\"pre\">main</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">staging</span></code> branches.\nTesting will also be performed as part of the <a class=\"reference internal\" href=\"../deploying/#deploying\"><span class=\"std std-ref\">automated deployment</span></a>.</p>\n<ul class=\"simple\">\n<li><p>Failing tests are will block any automated deployments</p></li>\n<li><p>We recommend configuring your repository to block pull-request merges unless a passing test has been registered</p></li>\n</ul>\n<section id=\"automated-testing-setup\">\n<h3>Automated testing setup<a class=\"headerlink\" href=\"#automated-testing-setup\" title=\"Permalink to this heading\">#</a></h3>\n<p>Testing requires that you set a GitHub secret named <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship_key_test</span></code>. This secret will be used to set the <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_API_KEY</span></code> environment variable during test running.</p>\n</section>\n<section id=\"modifying-or-removing-automated-testing\">\n<h3>Modifying or removing automated testing<a class=\"headerlink\" href=\"#modifying-or-removing-automated-testing\" title=\"Permalink to this heading\">#</a></h3>\n<p>Automated tests are run from the GitHub workflow located in your plugin project at <code class=\"docutils literal notranslate\"><span class=\"pre\">.github/workflows/test.yml</span></code></p>\n</section>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.17.1: http://docutils.sourceforge.net/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["developing/deploying", "Deploying", "N", "next"], ["developing/running", "Running on Localhost", "P", "previous"]], "sourcename": "developing/testing.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Throw, Log, and Test!</a><ul>\n<li><a class=\"reference internal\" href=\"#logging\">Logging</a></li>\n<li><a class=\"reference internal\" href=\"#throwing-errors\">Throwing Errors</a></li>\n<li><a class=\"reference internal\" href=\"#manual-testing\">Manual Testing</a></li>\n<li><a class=\"reference internal\" href=\"#automated-testing\">Automated testing</a><ul>\n<li><a class=\"reference internal\" href=\"#automated-testing-setup\">Automated testing setup</a></li>\n<li><a class=\"reference internal\" href=\"#modifying-or-removing-automated-testing\">Modifying or removing automated testing</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "developing/testing", "sidebars": ["sidebar/brand.html", "sidebar/search.html", "sidebar/scroll-start.html", "sidebar/navigation.html", "sidebar/ethical-ads.html", "sidebar/scroll-end.html", "sidebar/variant-selector.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "furo_version": "2023.03.27", "furo_navigation_tree": "", "furo_hide_toc": false, "furo_pygments": {"light": {"background": "#f8f8f8", "foreground": "black"}, "dark": {"background": "#272822", "foreground": "#f8f8f2"}}}