{"parents": [{"link": "../", "title": "Developing Packages and Plugins"}], "prev": {"link": "../testing/", "title": "Throw, Log, and Test!"}, "next": {"link": "../monitoring/", "title": "Monitoring"}, "title": "Deploying", "meta": null, "body": "<section id=\"deploying\">\n<span id=\"id1\"></span><h1>Deploying<a class=\"headerlink\" href=\"#deploying\" title=\"Permalink to this heading\">#</a></h1>\n<p>Packages and plugins must be deployed before they can be used.</p>\n<p>New versions of your project automatically become the \u201cdefault\u201d version when new instances are created.\nUnless an instance specifically requests a version, this new default version will be used.</p>\n<section id=\"deploying-with-the-steamship-cli\">\n<h2>Deploying with the Steamship CLI<a class=\"headerlink\" href=\"#deploying-with-the-steamship-cli\" title=\"Permalink to this heading\">#</a></h2>\n<p>You can deploy a package or plugin with the Steamship CLI with single command from\nthe project root (make sure your python environment is active):</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>ship<span class=\"w\"> </span>deploy\n</pre></div>\n</div>\n<p>If you don\u2019t have a <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> yet, the deploy process will create one. After the command exits, wait a few minutes for your new infrastructure to be ready in the cloud.\nNew instances of your project will then be directed to the new version.</p>\n</section>\n<section id=\"deploying-via-github-actions\">\n<h2>Deploying via GitHub Actions<a class=\"headerlink\" href=\"#deploying-via-github-actions\" title=\"Permalink to this heading\">#</a></h2>\n<p>Each package and plugin project is created from a a template that has been pre-configured to\nauto-deploy within GitHub Actions when certain situations occur.</p>\n<p>Before you deploy, make sure the <code class=\"docutils literal notranslate\"><span class=\"pre\">handle</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">version</span></code> fields in your <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> file are set:</p>\n<ul class=\"simple\">\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">handle</span></code> property of <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code></p></li>\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">version</span></code> property of <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code></p></li>\n</ul>\n<p>Production deployments occur upon:</p>\n<ul class=\"simple\">\n<li><p>Pushes to <code class=\"docutils literal notranslate\"><span class=\"pre\">main</span></code></p></li>\n<li><p>Pushes to SemVer-style tags, prefixed with <code class=\"docutils literal notranslate\"><span class=\"pre\">v</span></code> (<code class=\"docutils literal notranslate\"><span class=\"pre\">vA.B.C</span></code>)</p></li>\n</ul>\n<p>Staging deployments occur upon:</p>\n<ul class=\"simple\">\n<li><p>Pushes to <code class=\"docutils literal notranslate\"><span class=\"pre\">staging</span></code></p></li>\n</ul>\n<p>When pushing to a SemVer-style tag, the tag\u2019s version must match the\nversion contained within <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code>. Note that while the GitHub\nbranch must start with <code class=\"docutils literal notranslate\"><span class=\"pre\">v</span></code>, the version identifier in\n<code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> should omit it.</p>\n<p>When pushing to <code class=\"docutils literal notranslate\"><span class=\"pre\">main</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">staging</span></code>, the version contained in\n<code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> is used.</p>\n<section id=\"automated-deployment-setup\">\n<h3>Automated Deployment Setup<a class=\"headerlink\" href=\"#automated-deployment-setup\" title=\"Permalink to this heading\">#</a></h3>\n<p>Automated deployments can only occur if you have set the following\nGitHub secrets:</p>\n<ul class=\"simple\">\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_KEY</span></code> GitHub repository secret</p></li>\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_API_BASE</span></code> GitHub repository secret (optional)</p></li>\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_KEY_STAGING</span></code> GitHub repository secret</p></li>\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_API_BASE_STAGING</span></code> GitHub repository secret\n(optional)</p></li>\n</ul>\n<p>Setting the following variable will additionally trigger Slack\nnotifications upon automated deployments:</p>\n<ul class=\"simple\">\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_SLACK_DEPLOYMENT_WEBHOOK</span></code> Slack notification webhook\nURL (optional)</p></li>\n</ul>\n</section>\n<section id=\"modifying-or-disabling-automated-deployments\">\n<h3>Modifying or disabling automated deployments<a class=\"headerlink\" href=\"#modifying-or-disabling-automated-deployments\" title=\"Permalink to this heading\">#</a></h3>\n<p>Automated deployment is triggered by the GitHub Actions workflow in\n<code class=\"docutils literal notranslate\"><span class=\"pre\">.github/workflows/deploy.yml</span></code>. This file, in turn, invokes the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">steamship-core/deploy-to-steamship&#64;main</span></code> action.</p>\n<p>To modify or disable automated deployments, remove, comment out, or\nmodify that file.</p>\n</section>\n</section>\n<section id=\"troubleshooting-deployments\">\n<h2>Troubleshooting Deployments<a class=\"headerlink\" href=\"#troubleshooting-deployments\" title=\"Permalink to this heading\">#</a></h2>\n<section id=\"the-deployment-fails-because-the-version-already-exists\">\n<h3>The deployment fails because the version already exists<a class=\"headerlink\" href=\"#the-deployment-fails-because-the-version-already-exists\" title=\"Permalink to this heading\">#</a></h3>\n<p>This means the version specified in <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> has already been\nregistered with Steamship. Simply update the version in\n<code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> to an identifier that has not yet been used.</p>\n</section>\n<section id=\"the-deployment-fails-because-the-tag-does-not-match-the-manifest-file\">\n<h3>The deployment fails because the tag does not match the manifest file<a class=\"headerlink\" href=\"#the-deployment-fails-because-the-tag-does-not-match-the-manifest-file\" title=\"Permalink to this heading\">#</a></h3>\n<p>This means you have tried to push a branch with a semver-style tag (like\n<code class=\"docutils literal notranslate\"><span class=\"pre\">v1.2.3</span></code>), resulting in a version deployment whose name must match\nthat tag without the <code class=\"docutils literal notranslate\"><span class=\"pre\">v</span></code> prefix (<code class=\"docutils literal notranslate\"><span class=\"pre\">1.2.3</span></code>). Make sure the version\nfield of <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> matches this string.</p>\n<p>For example, if you are deploying branch <code class=\"docutils literal notranslate\"><span class=\"pre\">v6.0.0</span></code>, the <code class=\"docutils literal notranslate\"><span class=\"pre\">version</span></code>\nfield of your <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code> file must be <code class=\"docutils literal notranslate\"><span class=\"pre\">6.0.0</span></code></p>\n</section>\n<section id=\"the-deployment-fails-with-an-authentication-error\">\n<h3>The deployment fails with an authentication error<a class=\"headerlink\" href=\"#the-deployment-fails-with-an-authentication-error\" title=\"Permalink to this heading\">#</a></h3>\n<p>If you\u2019re deploying from GitHub Actions, make sure you\u2019re set your\n<code class=\"docutils literal notranslate\"><span class=\"pre\">STEAMSHIP_KEY</span></code> in your GitHub secrets. If you\u2019re deploying from your\nlocal machine, make sure you\u2019ve authenticated with the Steamship CLI.</p>\n</section>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.17.1: http://docutils.sourceforge.net/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["developing/monitoring", "Monitoring", "N", "next"], ["developing/testing", "Throw, Log, and Test!", "P", "previous"]], "sourcename": "developing/deploying.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Deploying</a><ul>\n<li><a class=\"reference internal\" href=\"#deploying-with-the-steamship-cli\">Deploying with the Steamship CLI</a></li>\n<li><a class=\"reference internal\" href=\"#deploying-via-github-actions\">Deploying via GitHub Actions</a><ul>\n<li><a class=\"reference internal\" href=\"#automated-deployment-setup\">Automated Deployment Setup</a></li>\n<li><a class=\"reference internal\" href=\"#modifying-or-disabling-automated-deployments\">Modifying or disabling automated deployments</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#troubleshooting-deployments\">Troubleshooting Deployments</a><ul>\n<li><a class=\"reference internal\" href=\"#the-deployment-fails-because-the-version-already-exists\">The deployment fails because the version already exists</a></li>\n<li><a class=\"reference internal\" href=\"#the-deployment-fails-because-the-tag-does-not-match-the-manifest-file\">The deployment fails because the tag does not match the manifest file</a></li>\n<li><a class=\"reference internal\" href=\"#the-deployment-fails-with-an-authentication-error\">The deployment fails with an authentication error</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "developing/deploying", "sidebars": ["sidebar/brand.html", "sidebar/search.html", "sidebar/scroll-start.html", "sidebar/navigation.html", "sidebar/ethical-ads.html", "sidebar/scroll-end.html", "sidebar/variant-selector.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "furo_version": "2023.03.27", "furo_navigation_tree": "", "furo_hide_toc": false, "furo_pygments": {"light": {"background": "#f8f8f8", "foreground": "black"}, "dark": {"background": "#272822", "foreground": "#f8f8f2"}}}