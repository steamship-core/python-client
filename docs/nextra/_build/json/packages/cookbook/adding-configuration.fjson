{"parents": [], "prev": null, "next": null, "title": "Making a package or plugin user-configurable", "meta": null, "body": "<section id=\"making-a-package-or-plugin-user-configurable\">\n<h1>Making a package or plugin user-configurable<a class=\"headerlink\" href=\"#making-a-package-or-plugin-user-configurable\" title=\"Permalink to this heading\">#</a></h1>\n<p>This example demonstrates how to make your package or plugin configurable by a user. To add configuration to your package or plugin, you need to do a few things.</p>\n<p>First, you need to declare a <code class=\"docutils literal notranslate\"><span class=\"pre\">configTemplate</span></code> in your <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code>.</p>\n<div class=\"highlight-json notranslate\"><div class=\"highlight\"><pre><span></span>{\n    &quot;type&quot;: &quot;package&quot;,\n    &quot;handle&quot;: &quot;a-configurable-package&quot;,\n    ...\n    &quot;configTemplate&quot;: {\n        &quot;name&quot;: {\n            &quot;type&quot;: &quot;string&quot;,\n            &quot;description&quot;: &quot;The name of the user.&quot;,\n            &quot;default&quot;: &quot;you&quot;\n        },\n        &quot;favorite_color&quot;: {\n            &quot;type&quot;: &quot;string&quot;,\n            &quot;description&quot;: &quot;The user&#39;s favorite color.&quot;\n        },\n        &quot;lucky_number&quot;: {\n            &quot;type&quot;: &quot;number&quot;,\n            &quot;description&quot;: &quot;The user&#39;s lucky number&quot;\n        },\n        &quot;favorite_true_false_value&quot;: {\n            &quot;type&quot;: &quot;string&quot;,\n            &quot;description&quot;: &quot;The user&#39;s favorite boolean value, true or false.&quot;\n        }\n    }\n}\n</pre></div>\n</div>\n<p>With this <code class=\"docutils literal notranslate\"><span class=\"pre\">configTemplate</span></code> in the <code class=\"docutils literal notranslate\"><span class=\"pre\">steamship.json</span></code>, Steamship users will be required to\nprovide a configuration when instantiating this package:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Steamship</span><span class=\"o\">.</span><span class=\"n\">use</span><span class=\"p\">(</span><span class=\"s2\">&quot;a-configurable-package&quot;</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"o\">=</span><span class=\"p\">{</span>\n    <span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Dave&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;favorite_color&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;blue&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;lucky_number&quot;</span><span class=\"p\">:</span> <span class=\"mi\">6</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;favorite_true_false_value&quot;</span><span class=\"p\">:</span> <span class=\"kc\">False</span>\n<span class=\"p\">})</span>\n</pre></div>\n</div>\n<p>This config will be validated at the time of instance creation for completeness and correct types.</p>\n<p>Since we provided a default value for <code class=\"docutils literal notranslate\"><span class=\"pre\">name</span></code> in the template, that value can be omitted and <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;you&quot;</span></code>\nwill be used instead.</p>\n<p>Now, within the code, you must do a few things.  First, you define the inner class that represents the configuration:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">ConfigurableFavoritesPackage</span><span class=\"p\">(</span><span class=\"n\">PackageService</span><span class=\"p\">):</span>\n    <span class=\"k\">class</span> <span class=\"nc\">FavoritesConfig</span><span class=\"p\">(</span><span class=\"n\">Config</span><span class=\"p\">):</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Configuration required to instantiate this package.&quot;&quot;&quot;</span>\n\n        <span class=\"n\">name</span><span class=\"p\">:</span> <span class=\"nb\">str</span>\n        <span class=\"n\">favorite_color</span><span class=\"p\">:</span> <span class=\"nb\">str</span>\n        <span class=\"n\">lucky_number</span><span class=\"p\">:</span> <span class=\"nb\">float</span>\n        <span class=\"n\">favorite_true_false_value</span><span class=\"p\">:</span> <span class=\"nb\">bool</span>\n</pre></div>\n</div>\n<p>The names of the fields <strong>must</strong> align with the names in the <code class=\"docutils literal notranslate\"><span class=\"pre\">configTemplate</span></code>.</p>\n<p>Next, we tell the Steamship handler how to find our config class:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">ConfigurableFavoritesPackage</span><span class=\"p\">(</span><span class=\"n\">PackageService</span><span class=\"p\">):</span>\n    <span class=\"o\">...</span>\n    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">config_cls</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Type</span><span class=\"p\">[</span><span class=\"n\">Config</span><span class=\"p\">]:</span>\n        <span class=\"k\">return</span> <span class=\"bp\">cls</span><span class=\"o\">.</span><span class=\"n\">FavoritesConfig</span>\n</pre></div>\n</div>\n<p>Now when implementing a method, we can use the config fields via <code class=\"docutils literal notranslate\"><span class=\"pre\">self.config.&lt;field_name&gt;</span></code>!</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"nd\">@post</span><span class=\"p\">(</span><span class=\"s2\">&quot;my_faves&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">def</span> <span class=\"nf\">my_faves</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Return the user&#39;s favorites, in a string.&quot;&quot;&quot;</span>\n\n    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">    Hey </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">!</span>\n<span class=\"s2\">    I can remind you of your favorites.</span>\n<span class=\"s2\">    Your favorite color is </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">favorite_color</span><span class=\"si\">}</span><span class=\"s2\">.</span>\n<span class=\"s2\">    Your lucky number is </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">lucky_number</span><span class=\"si\">}</span><span class=\"s2\">.</span>\n<span class=\"s2\">    Your favorite true/false value is </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">favorite_true_false_value</span><span class=\"si\">}</span><span class=\"s2\">.</span>\n<span class=\"s2\">    Wow, mine too!</span>\n<span class=\"s2\">    &quot;&quot;&quot;</span>\n</pre></div>\n</div>\n<p>When you put it all together, it looks like this:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">This package demonstrates how configuration works in Steamship.</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"kn\">from</span> <span class=\"nn\">typing</span> <span class=\"kn\">import</span> <span class=\"n\">Dict</span><span class=\"p\">,</span> <span class=\"n\">Any</span><span class=\"p\">,</span> <span class=\"n\">Type</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">steamship</span> <span class=\"kn\">import</span> <span class=\"n\">Steamship</span>\n<span class=\"kn\">from</span> <span class=\"nn\">steamship.invocable</span> <span class=\"kn\">import</span> <span class=\"n\">PackageService</span><span class=\"p\">,</span> <span class=\"n\">Config</span><span class=\"p\">,</span> <span class=\"n\">post</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">ConfigurableFavoritesPackage</span><span class=\"p\">(</span><span class=\"n\">PackageService</span><span class=\"p\">):</span>\n    <span class=\"k\">class</span> <span class=\"nc\">FavoritesConfig</span><span class=\"p\">(</span><span class=\"n\">Config</span><span class=\"p\">):</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Configuration required to instantiate this package.&quot;&quot;&quot;</span>\n\n        <span class=\"n\">name</span><span class=\"p\">:</span> <span class=\"nb\">str</span>\n        <span class=\"n\">favorite_color</span><span class=\"p\">:</span> <span class=\"nb\">str</span>\n        <span class=\"n\">lucky_number</span><span class=\"p\">:</span> <span class=\"nb\">float</span>\n        <span class=\"n\">favorite_true_false_value</span><span class=\"p\">:</span> <span class=\"nb\">bool</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">client</span><span class=\"p\">:</span> <span class=\"n\">Steamship</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">:</span> <span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">Any</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">context</span><span class=\"p\">:</span> <span class=\"n\">InvocationContext</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"c1\"># The superclass init method turns the config param (a Dict)</span>\n        <span class=\"c1\"># into the self.config object (here, a FavoritesConfig)</span>\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">)</span>\n\n\n    <span class=\"c1\"># The config_cls method allows your package to return a class</span>\n    <span class=\"c1\"># that defines its required configuration.</span>\n    <span class=\"c1\"># See Developer Reference -&gt; Accepting Configuration</span>\n    <span class=\"c1\"># for more details. This package uses a few configuration fields</span>\n    <span class=\"c1\"># to record the package user&#39;s favorite things.</span>\n    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">config_cls</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Type</span><span class=\"p\">[</span><span class=\"n\">Config</span><span class=\"p\">]:</span>\n        <span class=\"k\">return</span> <span class=\"bp\">cls</span><span class=\"o\">.</span><span class=\"n\">FavoritesConfig</span>\n\n    <span class=\"c1\"># This method defines the package user&#39;s endpoint for adding content</span>\n    <span class=\"c1\"># The @post annotation automatically makes the method available as</span>\n    <span class=\"c1\"># an HTTP Post request. The name in the annotation defines the HTTP</span>\n    <span class=\"c1\"># route suffix, see Packages -&gt; Package Project Structure.</span>\n    <span class=\"nd\">@post</span><span class=\"p\">(</span><span class=\"s2\">&quot;my_faves&quot;</span><span class=\"p\">)</span>\n    <span class=\"k\">def</span> <span class=\"nf\">my_faves</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Return the user&#39;s favorites, in a string.&quot;&quot;&quot;</span>\n\n        <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">        Hey </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">!</span>\n<span class=\"s2\">        I can remind you of your favorites.</span>\n<span class=\"s2\">        Your favorite color is </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">favorite_color</span><span class=\"si\">}</span><span class=\"s2\">.</span>\n<span class=\"s2\">        Your lucky number is </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">lucky_number</span><span class=\"si\">}</span><span class=\"s2\">.</span>\n<span class=\"s2\">        Your favorite true/false value is </span><span class=\"si\">{</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">favorite_true_false_value</span><span class=\"si\">}</span><span class=\"s2\">.</span>\n<span class=\"s2\">        Wow, mine too!</span>\n<span class=\"s2\">        &quot;&quot;&quot;</span>\n</pre></div>\n</div>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.17.1: http://docutils.sourceforge.net/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"]], "sourcename": "packages/cookbook/adding-configuration.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Making a package or plugin user-configurable</a></li>\n</ul>\n", "display_toc": false, "page_source_suffix": ".rst", "current_page_name": "packages/cookbook/adding-configuration", "sidebars": ["sidebar/brand.html", "sidebar/search.html", "sidebar/scroll-start.html", "sidebar/navigation.html", "sidebar/ethical-ads.html", "sidebar/scroll-end.html", "sidebar/variant-selector.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "furo_version": "2023.03.27", "furo_navigation_tree": "", "furo_hide_toc": true, "furo_pygments": {"light": {"background": "#f8f8f8", "foreground": "black"}, "dark": {"background": "#272822", "foreground": "#f8f8f2"}}}